\chapter
 [Qoala: an Application Execution Environment for Quantum Internet Nodes]
 {Qoala: an Application Execution Environment for Quantum Internet Nodes}
\label{chp:qoala}

\begin{abstract}
In \cref{chp:qnodeos}, we presented a first-of-its-kind operating system for programmable quantum network nodes, called QNodeOS.
In this chapter, we present an extension of QNodeOS called Qoala, which introduces
(1) a unified program format for hybrid interactive classical-quantum programs, providing a well-defined target for compilers, and 
(2) a runtime representation of a program that allows joint scheduling of the hybrid classical-quantum program, multitasking, and asynchronous program execution.
Based on concrete design considerations, we put forward the architecture of Qoala, including the program structure and execution mechanism.
We implement Qoala in the form of a modular and extendible simulator that is validated against real-world quantum network hardware (available online).
However, Qoala is not meant to be purely a simulator, and implementation is planned on real hardware.
We evaluate Qoala's effectiveness and performance sensitivity to latencies and network schedules using an extensive simulation study.
Qoala provides a framework that opens the door for future computer science research into quantum network applications, including scheduling algorithms and compilation strategies that can now readily be explored using the framework and tools provided. 
\end{abstract}

\blfootnote{
This chapter is based on the preprint:
\fullcite{qoala_noprint}.
}

\iffullchapters
\input{chapters/main/qoala/introduction}
\input{chapters/main/qoala/related_work}
\input{chapters/main/qoala/design_considerations}
\input{chapters/main/qoala/architecture}
\input{chapters/main/qoala/implementation}
\input{chapters/main/qoala/evaluation}
\input{chapters/main/qoala/conclusion}

\section{Data availability}
The implementation of Qoala as a simulator can be found online~\cite{qoala2023simulator}.
The code and data supporting the evaluation can be found at~\cite{qoala-evaluation-data}.

% \addtocontents{toc}{\protect\setcounter{tocdepth}{1}}
\input{chapters/main/qoala/appendix/program_structure}
\input{chapters/main/qoala/appendix/runtime_environment}
\input{chapters/main/qoala/appendix/scheduler}
\input{chapters/main/qoala/appendix/simulator}
\input{chapters/main/qoala/appendix/evaluation_details}
% \addtocontents{toc}{\protect\setcounter{tocdepth}{2}}
\fi


\begin{xstretch}
\printbibliography[heading=subbibintoc,title={References},notcategory=noprint]
\end{xstretch}